module.exports=function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=new n.Collection("keyvalue"),o=function(){function e(){}return e.set=function(e,t){return i.raw.update({_id:e},{data:t},{upsert:!0})},e.get=function(e){return i.findOne({_id:e}).then(function(e){return e?e.data:null})},e}();t.KeyValue=o},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,u)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(s=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(o,r[1])).done)return s;switch(o=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],o=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,o,s,u,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u};Object.defineProperty(t,"__esModule",{value:!0});var o=r(14),s=r(2),u=function(){function e(){}return Object.defineProperty(e,"DB",{get:function(){return new Promise(function(e,t){o.connect("mongodb://127.0.0.1:27017",function(r,n){!r&&n&&e(n.db("iiitn")),t("Couldn't connect to database.")}),setTimeout(function(){t("Connection to database timedout.")},5e3)})},enumerable:!0,configurable:!0}),e}(),c=function(){function e(e){this.findOne=this.findOne.bind(this),this.getMany=this.getMany.bind(this),this.update=this.update.bind(this),this.insert=this.insert.bind(this),this.init=this.init.bind(this),this.init(e)}return e.prototype.init=function(e){return n(this,void 0,void 0,function(){var t,r;return i(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,u.DB];case 1:return t=n.sent(),this._collection=t.collection(e),[3,3];case 2:return r=n.sent(),console.error("Couldn't connect to database."),process.exit(),[3,3];case 3:return[2]}})})},Object.defineProperty(e.prototype,"raw",{get:function(){return this._collection},enumerable:!0,configurable:!0}),e.prototype.__map=function(e){return{toArray:function(){return e.toArray()},toObject:function(){var t={};return e.toArray().then(function(e){return e.map(function(e){t[e._id]=e}),t})}}},e.prototype.update=function(e,t){return n(this,void 0,void 0,function(){var r,n;return i(this,function(i){switch(i.label){case 0:if(t&&(r=s.Schema.validate(t,e)))return[2,Promise.reject(r)];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._collection.updateOne({_id:e._id},e)];case 2:return[2,i.sent()];case 3:throw n=i.sent();case 4:return[2]}})})},e.prototype.insert=function(e,t){return n(this,void 0,void 0,function(){var r,n;return i(this,function(i){switch(i.label){case 0:if(t&&(r=s.Schema.validate(t,e)))return[2,Promise.reject(r)];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._collection.insertOne(e)];case 2:return[2,i.sent()];case 3:throw n=i.sent();case 4:return[2]}})})},e.prototype.findOne=function(e,t){return n(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,this._collection.findOne(e,{fields:t}).catch(function(){return Promise.reject("Couldn't find Record.")})];case 1:return[2,r.sent()]}})})},e.prototype.getMany=function(e,t){return this.__map(this._collection.find(e,t))},e}();t.Collection=c},function(e,t){e.exports=require("classui/Components/Form/Schema")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(16);t.S_User=n.S_User,t.S_UserLogin=n.S_UserLogin;var i=r(17);t.S_Question=i.S_Question;var o=r(4);t.S_Task=o.S_Task,t.S_UserTask_Details=o.S_UserTask_Details},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.S_Task={oneOf:[{type:"object",properties:{type:{const:"CANVAS2D"},title:{type:"string"},question:{type:"string"},resetCode:{type:"string"}},required:["type","title","question","resetCode"]}]};var n={type:"string",pattern:"^[a-zA-Z0-9-]{1,50}$"};t.S_UserTask_Details={oneOf:[{type:"object",properties:{_id:n,type:{const:"CANVAS2D"},code:{type:"string"},result:{enum:["PENDING","WRONG","CAN_BE_IMPROVED","GOOD","PIXEL_PERFECT"]},comments:{type:"string"}},required:["type","code","result"]},{type:"object",properties:{_id:n,type:{const:"TYPESCRIPT"},code:{type:"string"},result:{enum:["PENDING","WRONG","RIGHT"]}},required:["type","code","result"]}]}},function(e,t){e.exports=require("classui/DataStructures/OrderedMap")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),i=r(8),o=r(9),s=r(10),u=r(11),c=n(),a=new o.Server(c),l=s(a);c.use(n.static("./")),c.get("*",function(e,t){t.sendFile(i.resolve("./index.html"))});var f=a.listen(80,function(){var e=f.address().address,t=f.address().port;console.log("Server started : "+e+" : "+t)});l.on("connection",function(e){console.log("Connection..."),new u.Connection(e)})},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("socket.io")},function(e,t,r){"use strict";var n=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]]);return r};Object.defineProperty(t,"__esModule",{value:!0});var i=r(12),o=r(20),s=r(21),u=function(){function e(e){this.socket=e,this.initialize()}return e.prototype.processRequest=function(e){var t=this;switch(e.type){case"USER_LOGIN":return i.User.login(e.data).then(function(e){var r=e.ref,i=n(e,["ref"]);return t.user=r,i});case"REGISTER":return i.User.register(e.data);case"STUDENTS":return i.User.getStudents();case"PROFILE":return i.User.getProfile(e.data.userid);case"TASK_ACTION":return i.Task.performAction(e.data)}if(!this.user)return Promise.reject("User should be authenticated first.");switch(e.type){case"USER_SAVE_TASK":return this.user.saveTask(e.data);case"GUIDE_INIT":return i.Guide.performAction(e.type,e.data)}if("admin"!=this.user.userid)return Promise.reject("User should be an admin.");switch(e.type){case"GUIDE_MODULE_ACTION":return i.Guide.performAction(e.type,e.data)}return Promise.reject("Request type "+e.type+" not found.")},e.prototype.initialize=function(){var e=this,t=[],r=!1,n=function(){if(!r){if(r=!0,0==t.length)return void(r=!1);var i=t[0];t=s.drop(t),e.processRequest(i).then(function(t){var s={data:t};e.socket.emit(o.getResponseID(i.id),s),r=!1,n()}).catch(function(t){var s={error:t};e.socket.emit(o.getResponseID(i.id),s),r=!1,n()})}};this.socket.on("request",function(e){t.push(e),n()})},e}();t.Connection=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(13);t.User=n.User,t.UserDB=n.UserDB;var i=r(18);t.Task=i.Task;var o=r(0);t.KeyValue=o.KeyValue;var s=r(19);t.Guide=s.Guide},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(t,"__esModule",{value:!0});var i=r(1),o=r(15),s=r(2),u=r(3),c=r(4);t.UserDB=new i.Collection("user");var a=function(){function e(e){this.userid=e}return e.register=function(e){return e.tasks={},e.secretKey=o.v4(),t.UserDB.insert(e,u.S_User).then(function(t){return Promise.resolve("User "+e._id+" successfully registered.")}).catch(function(e){return Promise.reject("User already exists.")})},e.login=function(r){return t.UserDB.findOne({_id:r.userid}).then(function(t){return t?t.password==r.password||t.secretKey==r.secretKey?Promise.resolve({ref:new e(r.userid),secretKey:t.secretKey,tasks:t.tasks}):Promise.reject("Invalid password."):Promise.reject("User Not Found.")})},e.getStudents=function(){return t.UserDB.getMany({}).toArray().catch(function(){throw"Couldn't get students."})},e.getProfile=function(e){return t.UserDB.findOne({_id:e}).then(function(e){return e?Promise.resolve(e):Promise.reject("User Details not found.")}).catch(function(){return Promise.reject("Error getting profile details.")})},e.prototype.saveTask=function(e){e.taskDetails=n({result:"PENDING"},e.taskDetails);var r=s.Schema.validate(c.S_UserTask_Details,e.taskDetails);return r?Promise.reject(r):t.UserDB.raw.updateOne({_id:this.userid},{$set:(i={},i["tasks."+e.taskDetails._id]=e.taskDetails,i)}).then(function(){return Promise.resolve(e)}).catch(function(){return Promise.reject("Couldn't save.")});var i},e}();t.User=a},function(e,t){e.exports=require("mongodb")},function(e,t){e.exports=require("uuid")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.S_User={type:"object",properties:{_id:{type:"string",pattern:"(^N\\d{6}$)|(admin)"},name:{type:"string"},email:{type:"string",format:"email"},password:{type:"string",minLength:5},batch:{enum:["E1","E2","E3","E4"]},branch:{enum:["CSE","MME","ECE","MECH","CHEMICAL"]}}},t.S_UserLogin={type:"object",properties:{userid:t.S_User.properties._id,password:t.S_User.properties.password}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.S_Question={type:"object",properties:{title:{type:"string"},description:{type:"string"}}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,u)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(s=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(o,r[1])).done)return s;switch(o=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],o=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,o,s,u,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u};Object.defineProperty(t,"__esModule",{value:!0});var o=r(3),s=r(5),u=r(0),c=function(){function e(){}return e.prototype.__init=function(){return u.KeyValue.get("TASKS_DB").then(function(e){return new s.OrderedMap(e,o.S_Task)})},e.prototype.performAction=function(e){var t=this;return new Promise(function(r,o){return n(t,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:return this.orderedMap?[3,2]:(t=this,[4,this.__init()]);case 1:t.orderedMap=n.sent(),n.label=2;case 2:return e.orderedMapAction=this.orderedMap.performAction(e.orderedMapAction),u.KeyValue.set("TASKS_DB",this.orderedMap.getState()),r(e),[2]}})})}).catch(console.error)},e}();t._Task=c,t.Task=new c},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,u)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(s=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(o,r[1])).done)return s;switch(o=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,o=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],o=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,o,s,u,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u};Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),s=r(0),u=function(){function e(){}return e.prototype.__init=function(){return s.KeyValue.get("GUIDE_DB").then(function(e){return e||(e={}),e})},e.prototype.performAction=function(e,t){var r=this;return t.type=e,new Promise(function(e,u){return n(r,void 0,void 0,function(){var r,n;return i(this,function(i){switch(i.label){case 0:return this.guideState?[3,2]:(r=this,[4,this.__init()]);case 1:r.guideState=i.sent(),i.label=2;case 2:switch(t.type){case"GUIDE_INIT":t.state=this.guideState;break;case"GUIDE_MODULE_ACTION":if(!t.guide_id)return[2,u("Guide id should be provided.")];n=new o.OrderedMap(this.guideState[t.guide_id]),t.orderedMapAction=n.performAction(t.orderedMapAction),this.guideState[t.guide_id]=n.getState(),s.KeyValue.set("GUIDE_DB",this.guideState)}return e(t),[2]}})})}).catch(console.error)},e}();t.Guide=new u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getResponseID=function(e){return"response_"+e}},function(e,t){e.exports=require("lodash")}]);