module.exports=function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e,t){e.exports=require("mongodb")},function(e,t){e.exports=require("es6-promise")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=r(4),s=r(5),i=r(6),u=r(7),c=n(),a=new s.Server(c),d=i(a);c.use(n.static("./")),c.get("*",function(e,t){t.sendFile(o.resolve("./index.html"))});var f=a.listen(80,function(){var e=f.address().address,t=f.address().port;console.log("Server started : "+e+" : "+t)});d.on("connection",function(e){console.log("Connection..."),new u.Connection(e)})},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("socket.io")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8),o=r(16),s=function(){function e(e){this.socket=e,this.initialize()}return e.prototype.processRequest=function(e){var t=this;switch(e.type){case"LOGIN":return n.User.login(e.data._id,e.data.password,e.data.secretKey).then(function(e){return t.user=e.ref,{secretKey:e.secretKey}});case"REGISTER":return n.User.register(e.data);case"STUDENTS":return n.Database.getStudents();case"PROFILE":return n.Database.getProfile(e.data.userid)}if(!this.user)return Promise.reject("User should be authenticated first.");switch(e.type){case"TASK_ADD":return n.Database.addTask(e.data);case"TASK_MODIFY":return n.Database.modifyTask(e.data);case"TASK_GET":return this.user.getTasks();case"TASK_SAVE":return this.user.saveTask(e.data.id,e.data.code)}return Promise.reject("Request type "+e.type+" not found.")},e.prototype.initialize=function(){var e=this;this.socket.on("request",function(t){e.processRequest(t).then(function(r){var n={data:r};e.socket.emit(o.getResponseID(t.id),n)}).catch(function(r){var n={error:r};e.socket.emit(o.getResponseID(t.id),n)})})},e}();t.Connection=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=r(10),s=r(11),i=r(1),u=r(15),c=r(0),a=function(e){return function(){return i.Promise.reject(e)}},d=function(){function e(){}return Object.defineProperty(e,"db",{get:function(){return n.DB.then(function(e){return i.Promise.resolve(e)},a("Failed to connect database."))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"db",{get:function(){return e.db},enumerable:!0,configurable:!0}),e.getStudents=function(){return this.db.then(function(e){return e.collection("user").find({}).toArray().then(function(e){return e=e.map(function(e){return f.getProfile(e)}),i.Promise.resolve(e)}).catch(a("Request Failed."))})},e.getProfile=function(e){return this.db.then(function(t){return t.collection("user").findOne({_id:e}).then(function(e){return e?i.Promise.resolve(e):i.Promise.reject("User Details not found.")})})},e.addTask=function(e){var t=o.Schema.validate(s.S_Task,e);return t?i.Promise.reject(t):this.db.then(function(t){return t.collection("task").insertOne(e).then(function(){return i.Promise.resolve("Successfully added.")}).catch(a("Couldn't add task."))})},e.modifyTask=function(e){var t=o.Schema.validate(s.S_Task,e);return t?i.Promise.reject(t):this.db.then(function(t){return t.collection("task").updateOne({_id:new c.ObjectID(e.id)},e).then(function(){return i.Promise.resolve("Successfully Modified.")}).catch(a("Couldn't modify task."))})},e}();t.Database=d;var f=function(){function e(e){this.userid=e}return Object.defineProperty(e,"db",{get:function(){return n.DB.then(function(e){return i.Promise.resolve(e)},a("Failed to connect database."))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"db",{get:function(){return e.db},enumerable:!0,configurable:!0}),e.register=function(e){var t=o.Schema.validate(s.S_User,e);return t?i.Promise.reject(t):(e.tasks={},e.secretKey=u.v4(),this.db.then(function(t){return t.collection("user").insertOne(e).then(function(t){return i.Promise.resolve("User "+e._id+" successfully registered.")}).catch(a("User Already Exist."))}))},e.login=function(t,r,n){return this.db.then(function(o){return o.collection("user").findOne({_id:t}).then(function(o){return o?o.password==r||o.secretKey==n?i.Promise.resolve({ref:new e(t),secretKey:o.secretKey}):i.Promise.reject("Invalid password."):i.Promise.reject("User Not Found.")})})},e.getProfile=function(e){return e},e.prototype.getTasks=function(){var e=this;return this.db.then(function(t){return t.collection("task").find({}).toArray().then(function(r){return t.collection("user").find({_id:e.userid},{tasks:1}).toArray().then(function(e){return i.Promise.resolve({userTasks:e,mainTasks:r})}).catch(a("Couldn't get tasks"))}).catch(a("Couldn't get tasks."))})},e.prototype.saveTask=function(e,t){var r=this,n={};return n["tasks."+e]=t,this.db.then(function(e){return e.collection("user").updateOne({_id:r.userid},{$set:n}).then(function(){return i.Promise.resolve("Successfully saved.")}).catch(function(e){return i.Promise.reject("Couldn't save."+JSON.stringify(e))})})},e}();t.User=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(0),s=r(1);t.DB=new s.Promise(function(e,t){n&&e(n),o.connect("mongodb://127.0.0.1:27017",function(r,o){if(r)return void t(new Error("Couldn't connect to database."));n=o.db("iiitn"),e(n)})})},function(e,t){e.exports=require("classui/Components/Form/Schema")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12);t.S_User=n.S_User,t.S_UserLogin=n.S_UserLogin;var o=r(13);t.S_Question=o.S_Question;var s=r(14);t.S_Task=s.S_Task},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.S_User={type:"object",properties:{_id:{type:"string",maxLength:7,minLength:7},name:{type:"string"},email:{type:"string",format:"email"},password:{type:"string",minLength:5},batch:{enum:["E1","E2","E3","E4"]},branch:{enum:["CSE","MME","ECE","MECH","CHEMICAL"]}}},t.S_UserLogin={type:"object",properties:{_id:t.S_User.properties._id,password:t.S_User.properties.password}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.S_Question={type:"object",properties:{title:{type:"string"},description:{type:"string"}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.S_Task={type:"object",properties:{_id:{type:"string"},question:{type:"string"},resetCode:{type:"string"}}}},function(e,t){e.exports=require("uuid")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getResponseID=function(e){return"response_"+e}}]);